#bluesoft alias
alias erp='cd ~/workspace/erp'
alias erp-vue='cd ~/workspace/erp/erp-web/src/main/webapp/erp-app-vue/'
alias up='bee dbchange:up'
alias down='bee dbchange:down'
alias tags='git-next-tags'
alias dcreate="bee dbchange:create "
alias dvalidate="bee data:validate "
alias dgenerate="bee data:generate "
alias resetd='git reset gulpfile.js erp-legacy/src/test/resources/tec.properties erp-main-parent/bee.properties erp-legacy/src/main/java/br/com/bluesoft/tec/service/financeiro/edi/TecFinanService.java'
alias ebashw='subl ~/.alias/work'

alias beep='/Users/rogerio/workspace/mandrake-bee/roda.sh'
alias beer='/Users/rogerio/workspace/mandrake-bee/remove.sh'
alias test='cd ~/workspace/erp/erp-main-parent && mvn test -T2C'

#################### FUNCTIONS #########################

download_arq_finan(){
	tenant=$1
	arquivo_key=$2
	url_finan="http://finan.bluesoft.com.br/$tenant/arquivo/arquivo.do?action=download&arquivoKey=$arquivo_key"
	open $url_finan
}

download_card_finan(){
    tenant=$1
    arquivo_key=$2
    url_finan="http://finan.bluesoft.com.br/$tenant/arquivo/arquivocard.do?action=download&arquivoKey=$arquivo_key"
    open $url_finan
}


finan_bank(){
    create_directories
	activate_bank
	connect_finan	
}

create_directories() { 
    mkdir -p /tmp/tecfinan/cnab240
    mkdir -p /tmp/tecfinan/redecard/
    mkdir -p /tmp/tecfinan/visanet/
    mkdir -p /tmp/tecfinan/amex/
    mkdir -p /tmp/tecfinan/global/
    mkdir -p /tmp/tecfinan/accesstage/
    mkdir -p /tmp/tecfinan/nexxera/
}

activate_bank(){
	sed -i.bak 's/tec.finan.on=0/tec.finan.on=1/g' "$ERP_HOME/erp-legacy/src/main/resources/tec.properties"
	sed -i.bak 's/tec.finan.bank.on=0/tec.finan.bank.on=1/g' "$ERP_HOME/erp-legacy/src/main/resources/tec.properties"
	rm "$ERP_HOME/erp-legacy/src/main/resources/tec.properties.bak"
}

connect_finan(){

	echo '
package br.com.bluesoft.tec.service.financeiro.edi;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.net.HttpURLConnection;
import java.net.URL;

import br.com.bluesoft.tec.dao.hibernate.ParametroClienteDao;

@Service
public class TecFinanService {
    //TODO - retornado url qualquer para nao dar erro para clientes q nao tem finan. DEBITO TECNICO
    private static final String FAKE_URL_BANK = "http://localhost:8082/tecfinan-web/remoting/bankService";
    private static final String FAKE_URL_CARD = "http://localhost:8082/tecfinan-web/remoting/cardsService";

    // Utilizando o ParametroClienteDao pois o ParametroSistemaService , nao funciona com o Spring 4.2.
    @Autowired
    private ParametroClienteDao parametroClienteDao;

    public String urlCard() {
//        String url = parametroClienteDao.obterValor(Parametro.TEC_FINAN_CARDS_HTTPREMOTINGURL.getNome());
//        return StringUtil.isNotEmpty(url) ? url: FAKE_URL_BANK;
        return FAKE_URL_CARD;
    }
    public String urlBank() {
//        String url = parametroClienteDao.obterValor(Parametro.TEC_FINAN_BANK_HTTPPORTADDRESS.getNome());
        return FAKE_URL_BANK;
    }
    public boolean isOnLine() {
        try {
//            final URL url = new URL(parametroClienteDao.obterValor(Parametro.TEC_FINAN_PING.getNome()));
            final URL url = new URL("http://localhost:8082/tecfinan-web/");
            final HttpURLConnection huc = (HttpURLConnection) url.openConnection();
            huc.setRequestMethod("GET");
            huc.connect();
            final int code = huc.getResponseCode();
            huc.disconnect();
            return code == 200 || code == 401;
        } catch (final Exception e) {
            return false;
        }
    }
}
	' >  ~/workspace/erp/erp-legacy/src/main/java/br/com/bluesoft/tec/service/financeiro/edi/TecFinanService.java
	
}